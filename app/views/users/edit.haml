- title 'Settings'

.page-header
  %h1 Settings

.row
  .span2
    %p= player_avatar_tag current_user.minecraft_player, size: :large
    %p You can change your avatar at #{link_to 'Minecraft.net', 'http://minecraft.net/profile', target: '_blank'}. If you do, it may take up to 24 hours to update.


  .span6
    = form_for current_user, url: update_user_path, method: :put, class: %w(form-horizontal) do |f|

      .control-group
        = f.label :first_name, 'Name', class: 'control-label'
        .control
          .row
            .span2
              = f.text_field :first_name, class: %w(span2), placeholder: 'First'
            .span2
              = f.text_field :last_name, class: %w(span2), placeholder: 'Last'

      .control-group
        = f.label :email, class: 'control-label'
        .control
          = f.text_field :email, class: %w(span4)

      %fieldset.notifications
        %legend Notifications
        = f.fields_for :notifications do |n|
          .control-group
            = n.label :world_membership_added, class: 'checkbox' do
              = n.check_box :world_membership_added, checked: f.object.notify?(:world_membership_added)
              You are added to a world

          .control-group
            = n.label :world_membership_request_created, class: 'checkbox' do
              = n.check_box :world_membership_request_created, checked: f.object.notify?(:world_membership_request_created)
              Someone asks to join your world

          .control-group
            = n.label :world_started, class: 'checkbox' do
              = n.check_box :world_started, checked: f.object.notify?(:world_started)
              A friend starts playing

          .control-group
            = n.label :world_started, class: 'checkbox' do
              = n.check_box :world_started, checked: f.object.notify?(:world_started)
              A friend starts playing

          .control-group
            = n.label :credits_reset, class: 'checkbox' do
              = n.check_box :credits_reset, checked: f.object.notify?(:credits_reset)
              Your monthly time is reset

          .control-group
            = n.label :world_comment_added, class: 'checkbox' do
              = n.check_box :world_comment_added, checked: f.object.notify?(:world_comment_added)
              Someone comments on a world

          .control-group
            = n.label :campaign, class: 'checkbox' do
              = n.check_box :campaign, checked: f.object.notify?(:campaign)
              Minefold releases new features

        %fieldset
          %legend Time
          - if current_user.pro?
            %p All the time!
            %p Your plan expires #{time_ago_in_words current_user.plan_expires_at} from now (#{I18n.l current_user.plan_expires_at.to_date, format: :long}).

          - else



      .form-actions
        = f.submit 'Update settings', class: %w(btn btn-primary)

  .span4
    %h2 Linked Accounts

    - if current_user.minecraft_player
      .row.mojang
        .span1
          = player_avatar_tag current_user.minecraft_player, size: :medium
        .span3
          %h4= current_user.minecraft_player.username
          %p
            Mojang.
            = link_to 'Not your username?', unlink_player_path, method: :put, data: {confirm: 'You will need to verify your new Minecraft account'}
