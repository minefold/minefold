- title 'Dashboard'

.page-header
  %h1 Dashboard

- if current_user.minecraft_player.worlds.empty?
  %section.onboard
    %p You need to join or create a new world to play on Minefold. To join a friend's world, go to its page and tap “Ask to play here”. However, if you want to start a new world you can use the “#{link_to 'Create a new world', new_worlds_path}” button. If you already have a single player world you can import it while creating a new world.

.row
  .span3
    - if can? :create, World
      = link_to 'Create a new world', new_worlds_path, class: %w(btn btn-large)

    - if not current_user.confirmed?
      %h4 Confirm your account
      %p You should have recieved an email with instructions on how to confirm your account.

  .span9
    - if current_user.minecraft_player.worlds.any?
      - ws = current_user.minecraft_player.worlds.sort_by {|w| t = w[:last_played_at] ; case t; when nil; 10.years.ago ; when String; Time.parse(t) ; else t; end }.reverse
      %ul.thumbnails
        - ws.take(3).each do |world|
          = render partial: 'worlds/card', object: world

      - if ws.size > 3
        .row
          - ws[3..-1].each do |world|
            %a.span6.world-card-mini{href: player_world_path(world.creator.minecraft_player, world)}
              %strong.fullname= world.fullname
              .world-stats
                .stat
                  %i.icon-user
                  = world.player_ids.count

                .stat
                  %i.icon-time
                  = credits_to_minutes(world.minutes_played)

                .stat
                  %i.icon-eye-open
                  = number_with_delimiter world.pageviews

    - else
      %p.empty You haven't created or joined any worlds yet.
