- title  'Create your account'

.page-header
  %h1 Sign up for Minefold

= form_for resource, as: resource_name, url: registration_path(resource_name) do |f|

  %fieldset
    = f.control_group :username do
      = f.label :username, class: 'control-label'
      .controls
        = f.text_field :username, autocomplete: 'off', autofocus: true, class: %w(span3)
      = error_message_for(f.object, :username)

    = f.control_group :email do
      = f.label :email, class: 'control-label'

      .controls
        = f.email_field :email, autocomplete: 'off', class: %w(span3)
      = error_message_for(f.object, :email)

    = f.control_group :password do
      = f.label :password, class: 'control-label'

      .controls
        = f.password_field :password, autocomplete: 'off', class: %w(span3)

      = error_message_for(f.object, :password)


    = f.control_group :password_confirmation do
      = f.label :password_confirmation, class: 'control-label'

      .controls
        = f.password_field :password_confirmation, autocomplete: 'off', class: %w(span3)

      = error_message_for(f.object, :password_confirmation)

    .form-actions
      = f.submit 'Create account', class: %w(btn btn-large btn-primary)
      = link_to 'Cancel', root_path, class: %w(btn btn-large)

- # This little piece of magic sets the distinct_id from Mixpanel's js so we can track people from when they are just surfing around on the web to when they're an actual user.
- content_for :tail do
  :javascript
    var form = $('form#new_user');
    form.submit(function(e) {
      $('<input></input>').attr({
          type: 'hidden',
          name: 'user[distinct_id]'
        }).val(mixpanel.get_property('distinct_id')).appendTo(form);
    });
