- title 'Settings'

.page-header
  %h1 Settings

.account-form-section.row
  .section-label.span2
    %h3 Profile

  .span6
    = form_for resource, method: :put do |f|
      .row
        .span1
          %img.img-circle{width: 60, height: 60, src: 'http://graph.facebook.com/chrsllyd/picture'}
        
        .span5
          .control-group
            .controls
              = f.text_field :username, placeholder: 'Username', class: %w(span3)
          
          .control-group
            .controls
              = f.text_field :first_name, placeholder: 'First name', class: %w(span2)
              = f.text_field :last_name, placeholder: 'Last name', class: %w(span2)
          
          .control-group
            .controls
              = f.email_field :email, placeholder: 'Email', disabled: true, class: %w(span4)
              %small.help-block If you'd like to change your email please contact support.

          .form-actions
            = f.submit 'Save', class: %w(btn btn-mini)


.account-form-section.row
  .section-label.span2
    %h3 Accounts

  .accounts.span6
    .account.account-facebook{class: ('is-linked' if resource.facebook_linked?)}
      .profile-image.pull-left
        - if resource.facebook_linked?
          = image_tag resource.facebook_avatar_url, width: 40, height: 40
      .account-details
        %h4
          Facebook
          - if resource.facebook_linked?
            (#{resource.name})
        %p
          - if resource.facebook_linked?
            %a{href: "//facebook.com/#{resource.facebook_uid}"} Profile
            &middot;
            %a{href: '#'} Use avatar as profile photo
            &middot;
            = link_to 'Unlink account', accounts_unlink_facebook_path, :method => :put, class: 'unlink-account'
          
          - else
            = link_to user_omniauth_authorize_path(:facebook) do
              Link your Facebook account for
              = credits_with_image(200)
    
    
    .account.account-minecraft{class: ('is-linked' if resource.minecraft_linked?)}
      .profile-image.pull-left
        - if resource.minecraft_linked?
          = image_tag resource.minecraft_avatar_url, width: 40, height: 40
      .account-details
        %h4
          Minecraft
          - if resource.minecraft_linked?
            (#{resource.players.minecraft.map(&:uid).to_sentence})
        %p
          - if resource.minecraft_linked?
            %a{href: '#'} Use avatar as profile photo
            &middot;
            = link_to 'Unlink account', accounts_unlink_minecraft_path, :method => :put, class: 'unlink-account'
          
          - else
            %a{href: '#'}
              Link your Minecraft account for
              = credits_with_image(200)


.account-form-section.row
  .section-label.span2
    %h3 Billing
  .span6
    = credits_with_image current_user.credits
    &middot;
    = link_to_buy_credits


.account-form-section.row
  .section-label.span2
    %h3 Notifications

  .span6
    = form_for resource, method: :put do |f|

      .control-group
        .controls
          = f.label :newsletter_mailer, class: %w(checkbox) do
            = f.check_box :newsletter_mailer
            Minefold newsletters

          = f.label :server_mailer, class: %w(checkbox) do
            = f.check_box :server_mailer
            Comments on servers

          = f.label :session_mailer, class: %w(checkbox) do
            = f.check_box :session_mailer
            Servers starting & stopping

      .form-actions
        = f.submit 'Save', class: %w(btn btn-mini)


.account-form-section.row
  .section-label.span2
    %h3 Password

  .span6
    = form_for resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }, class: %w(form-horizontal) do |f|

      .control-group
        .controls
          = f.password_field :current_password, placeholder: 'Current password'

      .control-group
        .controls
          = f.password_field :password, placeholder: 'New password'

      .control-group
        .controls
          = f.password_field :password_confirmation, placeholder: 'Confirm new password'

      .form-actions
        = f.submit 'Save', class: %w(btn btn-mini)
