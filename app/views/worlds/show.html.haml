%header
  %h1= @world.name
  
#mcmap(style="height: 500px; width:940px; display:none")

- if user_signed_in? && current_user.special?
  .info
    - if current_user.world == @world
      %p In Minecraft, please connect to <strong>#{@world.host}</strong>.
    - else
      = button_to 'Activate World', [:activate, @world]

#share
  = form_for [:comment, @world], method: :post do |f|
    = text_area_tag :body, '', rows: 2
    %p
      %button Share

#stream
  - if @world.wall_items.empty?
    .empty No chat messages
  - else
    - @world.wall_items.each do |post|
      .item[post]
        - case post
        - when ChatMessage
          .author
            %span.username #{post.username}
          .msg= post.message
        - when Comment
          .avatar
            = image_tag post.user.gravatar_url(size: 48), width: 48, height: 48
          .author
            %span.username #{post.user.username}
          .msg= post.body
          
- map_asset_path = "/maps/world1"

%script(type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false")
%script{type:"text/javascript", src:"#{map_asset_path}/overviewerConfig.js"}
%script{type:"text/javascript", src:"#{map_asset_path}/overviewer.js"}
%script{type:"text/javascript", src:"#{map_asset_path}/markers.js"}
%script{type:"text/javascript", src:"#{map_asset_path}/regions.js"}

:javascript
  $(function(){
    $.extend(overviewerConfig.CONST.image, {
      defaultMarker: '#{map_asset_path}/signpost.png',
      signMarker:    '#{map_asset_path}/signpost_icon.png',
      compass:       '#{map_asset_path}/compass.png',
    });
    $.each(overviewerConfig.mapTypes, function(i, type) {
      type.path = '#{map_asset_path}/' + type.path;
    });
    overviewer.util.initialize()
  });
  